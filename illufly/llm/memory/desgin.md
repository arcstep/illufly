# 对话管理设计

## 分层查询策略

查询时，从L0开始，逐层查询，将所有层级的结果合并。
如果 L0 中的数据已经被上一层则忽略；

## 分层更新策略

1. L0 → L1: 对话到事实
    - 触发时机：新对话完成时
    - 更新策略：
        - 滚动窗口检查最近对话
        - 提取新事实，与已有事实比对
        - 相似事实合并或更新时间戳
        - 维护事实队列的时序性

2. L1 → L2: 事实到概念
    - 触发时机：事实队列更新时
    - 更新策略：
        - 从新事实中提取概念
        - 与现有概念库比对
        - 概念合并或演化记录
        - 更新概念间关系

3. L2 → L3: 概念到主题图
    - 触发时机：概念更新时
    - 更新策略：
        - 概念聚类形成主题
        - 更新主题内部关系
        - 维护主题间层级
        - 处理跨主题概念

4. L3 → L4: 主题图到观点
    - 触发时机：主题图变更时
    - 更新策略：
        - 基于主题路径生成观点
        - 更新观点依赖关系
        - 检查观点时效性
        - 维护观点一致性

5. 最终认知更新
    - 触发时机：会话认知完成时
    - 更新策略：
        - 合并新旧认知结构
        - 解决认知冲突
        - 更新时效性
        - 维护整体一致性
