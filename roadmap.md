
# 一、开发计划

**1. 一键直出**

由AI捕捉用户意图，首先创作结构化提纲，再逐个生成长篇文本；用户可在内容自动扩展的过程中对其精细控制。
> 例如，写一封长信，创作小说等。

**2. 模板直出**

用户首先上传预定的提纲模板，AI依据用户意图进行内容填充。
> 例如，依据既定格式制作商务提案。

**3. 长文理解**

用户上传文档，AI将解析文档结构，并生成结构化的大纲、概述和知识图谱。
> 例如，对已发布的电子书籍进行内容解析，并据此制作教育课程大纲。

**4. 长文仿写**

用户上传文档，AI首先构建结构化大纲，再依照大纲和原文风格撰写长文。
> 例如，在没有固定模板的情况下，依照案例文本的结构和风格草拟新的提案。

**5. 长文改写**

用户上传文档，AI将根据用户指示进行针对性的段落或句子修改。
> 例如，将文档中提及的某产品信息更新为最新版本。

**6. 长文翻译**

用户上传文档，AI先生成结构化大纲，然后根据大纲对各个段落进行翻译。
> 例如，将英文专业书籍转换为中文版本，保持原书结构及内容完整性。
> 再如，将超长的英文邮件翻译为中文版本，将英文官方网站中的一组网页文档翻译为中文版本。

**7. 长文嵌入**

在生成文本的过程中，模板将指出所需嵌入的图、表、代码块等位置，AI将根据上下文生成相应的嵌入图表，实现文本与图表的整合。

这进一步增强了长文生成功能，通过模板的指导，使得功能从文本扩展到包含表格和图形的完整文档制作。

**8. 长文比较**

对于两篇文章，可以从结构上比较，或从相同结构的内容细节上比较，找出关键的不同点。

**9. 长文讨论**

实现基于长文只是的RAG对话。

基于长文理解技术，可以将提纲结构、知识点等作为有参考价值的背景资料强化提示工程，而忽略应当过滤的模块（如代码生成结果等）。

# 二、设计要点

**1. 关键概念**
- [x] 提示语变量中包含历史对话，默认支持20轮次
- [x] 每个节点有独立的对话历史
- [x] 内容ID：在同一个对象中全局自增，如果重写会产生新的内容ID（这是为了与删除环不冲突）
- [ ] 删除环：每个修改命令将修改或删除前内容放入环形临时队列，以便恢复
- [ ] 恢复操作：不做回退，而是继续累加删除环
- [ ] 粘贴：先删除到删除环，再从修改环最后一个粘贴到指定位置

**2. 指令模型**
- [ ] 创作是一个状态机，每个状态有一组当下可执行的命令
- [x] 完整输入指令：`command args`
- [x] 支持多种运行模式: `auto`（自动确认至任务结束）, `repl`（终端循环）, `invoke`（单步）

**3. Web服务模式**
- [ ] 新项目对话
- [ ] 开启与对话绑定的创作
- [ ] 支持每一步指令的状态返回
- [ ] 支持流返回

**4. 模型支持**
- [ ] 支持手动创建LLM对象
- [x] 支持自动识别 ZHIPUAI_API_KEY 和 OPENAI_API_KEY，并自动加载包和构造LLM对象
- [ ] 支持文心一言、讯飞星火、通义千问等其他模型
- [ ] 支持私有部署大模型

**5. 提示工程**
- 提示语中的提纲信息：
  - [x] 模式1：全路径选标题、扩写指南和内容摘要？
  - [ ] 模式2：祖先节点选标题，兄弟节点选标题、扩写指南和内容摘要，最近节点选文字详情？
- [ ] 将最近节点生成过的文字作为提示语（使用`texts -500`)
- [ ] 提示语外部信息
- [ ] 提示语公共信息：在START节点配置
- [ ] 支持本地知识库检索
- [ ] 支持数据库查询
- [ ] 支持智能体询问

**6. 导出模板**
- [ ] 导出提示语模板：包括任务提示、局部提示语等
- [ ] 导出提纲：导出JSON文件，包括文档树的标题、字数、扩写指南、内容摘要等

**7. 导入模板**
- [ ] 导入提示语模板：从现有提示语目录中导入
- [ ] 导入提纲：从符合格式要求的JSON文件中
- [ ] 提纲仿写：从文件内容中提取出精确的仿写提纲
- [ ] 提纲优化：从文字内容中提取出段落摘要，反向拆解提纲，再给出优化建议

**8. 导出成果**
- [ ] 文字合并：如何对待提纲中的标题，作为段落合并还是作为章节？
- [ ] 支持局部导出
- [ ] 支持仅导出大纲
- 按格式输出
  - [ ] markdown
  - [ ] word
  - [x] txt

**9. 修改能力：**
- [ ] 删除：将内容及其子项剪切到删除环
- [ ] 排序：先剪切，再插入
- [ ] 重新生成提纲列表：若要重新生成提纲列表，必须手工清楚所有子项，否则禁止使用todo指令或对其修改
- [ ] todo指令：仅针对子项尚未完成的对象（如刚刚完成的，或其他兄弟节点）
- [ ] 修改提纲子项属性：需要单独使用title、words、howto等指令修改

**10. 其他设计：**
- [ ] 支持对日志输出着色